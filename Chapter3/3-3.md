### XOR 密钥重用

话不多说，直接上题（攻防世界）

![](https://pic1.imgdb.cn/item/67fa2ad088c538a9b5cc3b17.png)

下载附件

```shell
0529242a631234122d2b36697f13272c207f2021283a6b0c7908
2f28202a302029142c653f3c7f2a2636273e3f2d653e25217908
322921780c3a235b3c2c3f207f372e21733a3a2b37263b313012
2f6c363b2b312b1e64651b6537222e37377f2020242b6b2c2d5d
283f652c2b31661426292b653a292c372a2f20212a316b283c09
29232178373c270f682c216532263b2d3632353c2c3c2a293504
613c37373531285b3c2a72273a67212a277f373a243c20203d5d
243a202a633d205b3c2d3765342236653a2c7423202f3f652a18
2239373d6f740a1e3c651f207f2c212a247f3d2e65262430791c
263e203d63232f0f20653f207f332065262c3168313722367918
2f2f372133202f142665212637222220733e383f2426386b
```

简单来说呢，就是利用一些用同个密钥生成的密文，猜对其中部分密文对应的明文，即可求出公共密钥

再用该可能的密钥去解其他的密文，若符合，则为密钥正确

[下载脚本](https://github.com/SpiderLabs/cribdrag)

按一行展开

```shell
0529242a631234122d2b36697f13272c207f2021283a6b0c79082f28202a302029142c653f3c7f2a2636273e3f2d653e25217908322921780c3a235b3c2c3f207f372e21733a3a2b37263b3130122f6c363b2b312b1e64651b6537222e37377f2020242b6b2c2d5d283f652c2b31661426292b653a292c372a2f20212a316b283c0929232178373c270f682c216532263b2d3632353c2c3c2a293504613c37373531285b3c2a72273a67212a277f373a243c20203d5d243a202a633d205b3c2d3765342236653a2c7423202f3f652a182239373d6f740a1e3c651f207f2c212a247f3d2e65262430791c263e203d63232f0f20653f207f332065262c31683137223679182f2f372133202f142665212637222220733e383f2426386b
```

执行下脚本

```shell
python cribdrag.py 0529242a631234122d2b36697f13272c207f2021283a6b0c79082f28202a302029142c653f3c7f2a2636273e3f2d653e25217908322921780c3a235b3c2c3f207f372e21733a3a2b37263b3130122f6c363b2b312b1e64651b6537222e37377f2020242b6b2c2d5d283f652c2b31661426292b653a292c372a2f20212a316b283c0929232178373c270f682c216532263b2d3632353c2c3c2a293504613c37373531285b3c2a72273a67212a277f373a243c20203d5d243a202a633d205b3c2d3765342236653a2c7423202f3f652a182239373d6f740a1e3c651f207f2c212a247f3d2e65262430791c263e203d63232f0f20653f207f332065262c31683137223679182f2f372133202f142665212637222220733e383f2426386b
```

![](https://pic1.imgdb.cn/item/67fa2e5688c538a9b5cc40c8.png)

输入 `ALEXCTF{` "0" 的位置出现 "Dear Fri" 有戏

![](https://pic1.imgdb.cn/item/67fa2e8a88c538a9b5cc40df.png)

于是将其放入其中，按照步骤一步步来： （如下）

![](https://pic1.imgdb.cn/item/67fa2eff88c538a9b5cc4112.png)

补全前面 Dear Friend ，继续 。得到 `ALEXCTF{HER`

![](https://pic1.imgdb.cn/item/67fa2f7188c538a9b5cc413c.png)

就这样一步一步摸下来

最后得到

![](https://pic1.imgdb.cn/item/67fa2f8688c538a9b5cc4145.png)