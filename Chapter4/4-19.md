### Poem Codes 密码

话不多说，直接上题（攻防世界）

![](https://pic1.imgdb.cn/item/67f7cd8788c538a9b5c8fb57.png)

打开附件

![](https://pic1.imgdb.cn/item/67f7f05a88c538a9b5c9339f.png)

**密钥准备：诗歌**

- 通信双方需预先共享一首诗歌（或任何固定文本），作为密钥
- 例如，诗歌选自莎士比亚的十四行诗：
  *"Shall I compare thee to a summer's day?"*

**密钥处理：生成数字序列**

- 将诗歌转换为连续的字母，忽略标点、空格和大小写，并给每个字母按顺序编号（从 1 开始）：

  ```
  S(1), H(2), A(3), L(4), L(5), I(6), C(7), O(8), M(9), P(10), A(11), R(12), E(13), ...  
  ```

- 对每个字母，取其在诗歌中首次出现的位置编号，作为密钥数字

  例如，字母 `A` 首次出现在第 3 位，`E` 在第 13 位，`S` 在第 1 位

**加密过程：替换字母**

假设明文为 `"ATTACK"`，加密步骤如下：

1. 对齐明文与密钥数字：
   - 将明文每个字母对应的密钥数字按顺序写出（若诗歌不够长，可循环重复诗歌）
   - 例如，对 `A T T A C K`：
     - `A` → 首次在诗歌第3位 → 密钥数字 3
     - `T` → 若诗歌中无`T`，可跳过或约定默认值（如0）→ 需诗歌包含足够字母
       （假设诗歌扩展后 `T` 对应数字为20）
     - 最终密钥序列：`[3, 20, 20, 3, 7, ?]`
2. 字母位移（类似凯撒密码）：
   - 将明文字母在字母表中向后移动密钥数字对应的位数（模 26）
     - `A (1) + 3 = D (4)`
     - `T (20) + 20 = 40 → 40 - 26 = 14 → N (14)`
     - 最终密文：`D N N D H ?`

**解密过程**

解密者使用相同的诗歌密钥，反向操作：

1. 用相同的密钥数字序列 `[3, 20, 20, 3, 7, ?]`
2. 将密文字母向前移动密钥数字位：
   - `D (4) - 3 = A (1)`
   - `N (14) - 20 = -6 → 26 - 6 = 20 → T (20)`

[GitHub上有现成脚本](https://github.com/13957166977/crypto-tools/tree/master/poemcode)

将诗句存储成 poem.txt（记得删除里面的标点）

将解密信息存储成 cip.txt

```
python2 poemcode.py poem.txt cip.txt
```

![](https://pic1.imgdb.cn/item/67f7f23288c538a9b5c935ec.png)