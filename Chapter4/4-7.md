### Playfair

话不多说，直接上题（BUUCTF）

![](https://pic1.imgdb.cn/item/678543abd0e0a243d4f4010d.jpg)

Playfair 密码将明文以两两配对的方式加密，具体规则如下：

1. **准备密钥矩阵**：

   - 密钥是一个字符串，例如 `KEYWORD`
   - 移除重复字母，并按照字母顺序（不区分大小写）填充一个 5x5 的矩阵
   - 将字母 `I` 和 `J` 合并为一个字母（可以互相替换）
   - 剩余字母按照字母顺序依次填入

   例如，密钥为 `KEYWORD` 时，生成的矩阵为：

   ```
   K E Y W O
   R D A B C
   F G H I/J L
   M N P Q S
   T U V X Z
   ```

2. **分组明文**：

   - 明文按两个字母一组分组，例如 `HELLO` -> `HE LL Oz`
   - 如果两个字母相同（例如 `MEET` -> `ME ET`），在中间插入填充字母 `z` 
   - 如果最后一组只有一个字母，补充 `z`（例如 `O` -> `Oz`）

3. **加密规则**：

   - 同一行：
     - 如果一对字母在同一行，则用其右侧字母代替；行尾的字母回到行首
       - 例如：`WE` -> `OY`
   - 同一列：
     - 如果一对字母在同一列，则用其下方字母代替；列尾的字母回到列首
       - 例如：`ED` -> `DG`
   - 不同行列：
     - 如果一对字母不在同一行或列，则用其同行且与同组另一字母同列的字母代替
       - 例如：`HE` -> `GY`

**Playfair 密码特点：**

```
密文的字母数一定是偶数，任意两个同组的字母都不会相同，如果出现这种字符必是乱码和虚码
```

![](https://pic1.imgdb.cn/item/67854449d0e0a243d4f4011c.jpg)